import ddf.minim.*;
import ddf.minim.analysis.*;

Minim minim;
AudioInput in;
FFT fft;

void setup() {
  size(800, 600);
  
  minim = new Minim(this);
  in = minim.getLineIn();
  fft = new FFT(in.bufferSize(), in.sampleRate());
  
  textAlign(CENTER);
}

void draw() {
  background(255);
  
  fft.forward(in.mix);
  
  // Encontra a frequência dominante
  int maxIndex = 0;
  float maxAmplitude = 0;
  for (int i = 0; i < fft.specSize(); i++) {
    if (fft.getBand(i) > maxAmplitude) {
      maxAmplitude = fft.getBand(i);
      maxIndex = i;
    }
  }
  float freq = fft.indexToFreq(maxIndex);
  
  // Mostra a frequência dominante na tela
  fill(0);
  textSize(24);
  text("Frequência Dominante: " + freq + " Hz", width/2, height/2);
}

void stop() {
  in.close();
  minim.stop();
  super.stop();
}
